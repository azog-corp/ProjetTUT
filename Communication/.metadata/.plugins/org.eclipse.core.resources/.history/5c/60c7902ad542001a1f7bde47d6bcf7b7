package projet;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;
import java.net.Socket;
import java.net.SocketException;
import java.util.ArrayList;

import projet.Service;

public class Serveur {
   
  public static void main(String[] args) {
    
    try {
        DatagramSocket socket = new DatagramSocket(4523); 
        byte[] buffer;
        DatagramPacket paquet;
        System.out.println("Serveur lancé !");
        int compteur = 0;
         // Boucle sans fin pour lire un message et l'afficher
        // puis renvoyer un accusé réception
        while(true) {
        	buffer = new byte[100];
        	paquet = new DatagramPacket(buffer,100);
            socket.receive(paquet);
            new Service(""+compteur,socket,paquet,buffer);
            compteur++;
        }
      
    } catch(SocketException e) {
        System.out.println("Impossible de lancer le serveur :"+e);
    } catch(IOException e) {
        //stub
    }
  }
  
  public ArrayList<String> lectureFichier(String date){
		//CONVERSION = fct convertir date en string
		try {
			String ligne;
			date = conversion(date);
			ArrayList<String> temp = new ArrayList<String>();
			BufferedReader fic = new BufferedReader(new FileReader(new File("temperatures.txt")));
			while((ligne = fic.readLine()) != null) {
				if(date.compareTo(conversion(ligne)) < 0) {
					temp.add(ligne);
				}
			}
		}catch(IOException e) {
			System.out.println(e);
		}
	}

}
